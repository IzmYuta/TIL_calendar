---
layout: post
title: "ISUCON本_Ch6"
date: 2023-09-24
category: ISUCON
excerpt: ""
---
# Ch6. リバースプロキシの利用

## TL;DR
- リバースプロキシとは、ユーザーのリクエストを受け付け、アップストリームサーバーに転送するという、受け皿のような役割を持つものである
- パフォーマンスチューニングでは具体的に次のようなことを行う
  1. 転送時のデータ圧縮(gzipなど)
  2. リクエストとレスポンスのバッファリング
  3. リバースプロキシとアップストリームサーバーのコネクション管理

## Q
- リバースプロキシとは何か
- リバースプロキシはどのように実装するのか
- リバースプロキシをどのように使って高速化するのか
- nginxのアーキテクチャはどのようになっているのか
- 次を実現するためにはどうするのか
  - 転送時のデータ圧縮
  - リクエスト・レスポンスのバッファリング
  - アップストリームサーバーとのコネクション管理
  - TLS通信の高速化

## R
### リバースプロキシとは
- ユーザーのリクエストを受け付け、上位サーバー(アップストリームサーバー)に転送する仕組み
  - 次の役割を持つ：
  - 負荷分散
  - コンテンツのキャッシュ
  - HTTPS通信の終端

### リバースプロキシはなぜ必要か
- プロセスとスレッドのアーキテクチャ構造が深く関わっている
  - アプリサーバー：マルチプロセス・シングルスレッド
    - 多数のプロセスを展開するとメモリ負荷が大きい
    - クライアント数が多くなる(> 10000)と、コンテクストスイッチ(プロセスの切り替え)のためにパフォーマンスが急激に落ちる(**C10K問題**)

**アプリサーバーが直にリクエストを受け付けると、C10K問題により多数のユーザーを受け付けることが困難になるため、リバースプロキシによってこれを回避する必要があるから**
